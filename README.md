# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Арехетектура проекта:

В проекте было решено реализовать архитектуру **MVP**(Model, View, Presenter).

### Струкутра MVP 

1. **Модель (Model):**
Отвечает за работу с данными приложения.
  - Отвечает за работу с данными приложения.
  - Классы: `Api`, `ApiListResponse`, `ApiPostMethods`.

2. **Представление (View):**
Отображает данные пользователю.
  - Отвечает за отображение данных пользователю.
  - Классы: `ICard`, `IGallery`, `IPage`.

3. **Представитель (Presenter):**
Связывает Модель и Представление.
  - Осуществляет связь между Моделью и Представлением.
  - Классы: `EventEmitter`, `EventName`, `Subscriber`, `EmitterEvent`.
  - Файлы: `event.ts`.

## Базовый код

1. ### **Класс "Api" (Взаимодействие с серверным API):**

  **Класс API** — это класс который позволяет отправлять запросы к API.

  **Конструктор**

  ```
  constructor(baseUrl: string, options: RequestInit = {}) {
  ```

  **Аргументы**

  * `options` — опции запроса.
  * `baseUrl` — базовый URL API.

  **Методы**

  * `getUri(uri: string)` — отправляет GET-запрос к указанному URI.
  * `postUri(uri: string, data: object, method: ApiPostMethods = 'POST')` — отправляет POST-запрос к указанному URI.

  **Примечание**

  * Метод `postUri()` принимает третий аргумент `method`, который по умолчанию равен `'POST'`. Это означает, что вы можете использовать этот метод для отправки запросов POST, PUT и DELETE.
  * Метод `handleResponse()` обрабатывает ответ сервера и возвращает объект JSON. Если ответ сервера не является успешным, то он возвращает ошибку.

2. ### **Класс ProductAPI:**

  **ProductAPI** — это класс, который позволяет взаимодействовать с API продуктов.

  **Конструктор** 

  ```
  constructor(readonly cdn: string, baseUrl: string, options?: RequestInit) {
  ```
  **Аргументы**

  * `cdn` — URL CDN для изображений продуктов.
  * `baseUrl` — базовый URL API продуктов.
  * `options` — опции запроса.

  **Методы**

  * `getProductList()` — получает список всех продуктов.
  * `getProductItem(id: string)` — получает подробную информацию о продукте по его идентификатору.
  * `orderProduct(order: IOrder)` — размещает заказ на продукт.

  **Дополнительно**

  * Класс `ProductAPI` можно использовать для создания собственного интернет-магазина.
  * Класс `ProductAPI` можно использовать для интеграции с другими системами, например, с системой управления заказами.

3. ### **Класс "EventEmitter" (Брокер событий):**

  **Брокер событий** — это класс, который позволяет объектам подписываться на определённые типы событий и получать уведомления о них. Он действует как посредник между объектами, которые производят и обрабатывают сообщения.

  * **`on(eventName, callback)`**: подписывается на определённый тип событий.
  * **`once(eventName, callback)`**: подписывается на определённый тип событий один раз.
  * **`off(eventName, callback)`**: отписывается от определённого типа событий.
  * **`emit(eventName, data)`**: отправляет событие определённого типа.
  * **`onAll(callback)`**: подписывается на все события.
  * **`offAll()`**: отписывается от всех событий.
  * **`trigger(eventName, context)`**: создаёт коллбек-триггер, который генерирует событие при вызове.

## В данном случае мы можем распределить ваши классы по слоям **Модель** и **Представление**.

## **Компоненты модели данных**

**Класс `AppState` данный класс содержит состояние корзины, каталога товаров и заказа.**

Класс позволяет добавлять товары в состояния корзины и каталога методами `setBusket` и `setCatalog`, получить сумму заказа через `getTotal`, убрать товар из корзины removeBusket или очистить её `clearBasket`. Также класс позволяет методом `setOrderField` добавлять в состояние заказа данные, такие как: способ оплаты, почта, телефон, адрес, сумма и список товаров - эти данные нужны для отправки на сервер.

## **Компоненты представления**

## **PopupComponent**

Класс `PopupComponent` — это компонент, который можно применять для создания всплывающих модальных окон. Он обеспечивает единообразный внешний вид и поведение всплывающих окон во всём приложении.

**Свойства**

  * **`container`**: HTML-элемент, который будет содержать всплывающее окно.
  * **`events`**: объект `IEvents`, который будет использоваться для передачи событий при открытии или закрытии всплывающего окна.

  **Методы**

  * **`open()`**: открывает всплывающее окно.
  * **`close()`**: закрывает всплывающее окно.
  * **`render()`**: отображает всплывающее окно с указанными данными.

## **Basket**

Класс `Basket` описывает корзину. Он содержит следующие свойства:
В данном компоненте содержатся следующие поля:

* list - HTML-элемент со списком товаров в корзине;
* total - HTML-элемент содержащий итоговую сумму заказа.

`items(items: HTMLElement[])` — принимает список элементов и размещает их в листе.
`enable(length: number)` — принимает аргументом длину списка товаров и разблокирует кнопку оформления.
`total(total: number)` — устанавливает итоговую сумму в соответствующий HTML-элемент.
`selected: string[]` — массив идентификаторов выбранных товаров в корзине.

## **Form**

Класс `Form`является основой для форм приложения.

Компонент имеет следующие поля:

* submit - HTML-элемент кнопки подтверждения формы;
* errors - HTML-элемент для вывода ошибок валидации
класс имеет сеттер `valid(value: boolean)` для блокировки/разблокировки кнопки подтверждения и сеттер для установки сообщения об ошибке - `errors(value: string)`.

## **Page**
Класс `Page` позволяет вывести на старницу основные данные.

Компонент имеет следующие поля:

* counter - HTML-элемент счетчика количества товаров в корзине ;
* catalog - HTML-элемент галереи с товарами;
* wrapper - HTML-элемент основного контейнер всей страницы;
* basket - HTML-элемент кнопки корзины;

данный компонент имее сеттеры `counter(value: number)` и `catalog(items: HTMLElement[])` для установки содержимого в соответвующие элементы на страницы, а так же сеттер `locked(value: boolean)` для блокировки прокрутки страницы, с помощью набрасывания нужного класса на wrapper.

## **Card**
Класс `Card` является основой для компонентов, выводящих данные о товаре на страницу.

Имент следующие поля:

* title - HTML-элемент заголовка в карточке
* price - HTML-элемент цена товара
* button - HTML-элемент кнопки в карточке, если кнопи в данной карточке нет, то слушатель вешается на весь контейнер
данный класс включает следующие сеттеры: `id(value: string)`, `title(value: string)` и  `price(value: number)` для установки содержимого в соответвующие элементы на страницы.

## **CatalogCard**
расширяет класс `Card`, позволяет отображать карточку товара в галерее и на превью.

именнт следующие поля:

* category - HTML-элемент, в котором указана категория товара
* image - HTML-элемент, содержащий изобрадение товара
* description - HTML-элемент с описанием товара
компонент содержит ряд сеттеров для установки содержимого в элементы, а также метод `categoryColor(value: string)`, который используется в сеттере `category(value: string)` для отображения различного цвета контейнера категории.

## **BasketCard**
расширяет класс `Card` и используется для создания элементов списка корзины.

Добавляется поле `itemIndex`, представляющее собой HTML-элемент с порядковым номером заказа.

кроме сеттера `itemIndex(value: number)` в классе больше методов нет.

## **Payment**
данный класс является дочерним для класса `Form` и используется для работы с формой "Способ оплаты"

имеет следующие поля:

* buttons - массив с HTML-элементами кнопок
* address - HTML-элемент с инпутом для ввода адреса
Класс позволяет получить значение из инпута методом `getAddress()` и определить, выбран ли какой-либо способ оплаты методом `isSelected()`, вместе два данных метода позволяют определить. можно ли разблокировать кнопку подтверждения формы.

Так же в классе имеются следующие методы:

* selected(name) - переключение выбираемой кнопки с последующим снятием выборки с соседней;
* unselectAll() - убрать выборку со всех кнопок;
* getType - возвращает способ оплаты, используется для заполнения данных в статусе заказа(находящимся в AppState)
при создании экземпляра данного класса на кнопку подтверждения формы вешается обработчик, который открывает следующую форму или иное окно

## **Contacts**
данный класс является дочерним для класса `Form` и используется для работы с формой ввода почты и телефона.

имеет следующие поля:

* email - HTML-элемент с инпутом для ввода электронной почты
* phone - HTML-элемент с инпутом для ввода номера телефона
Класс позволяет получить значения из полей ввода методами `getEmail` и `getPhone`, который используются чтобы определить, можно ли разблокировать кнопку подтверждения формы.

при создании экземпляра данного класса на кнопку подтверждения формы вешается обработчик, который открывает следующую форму или иное окно.

## **Success**
данный класс используется для отображения окна с уведомлением об успешном заказе.

класс имеет следующие поля:

* description - HTML-элемент, содержащий текст с количеством списанных средств;
* close - HTML-элемент кнопки закрытия окна
в классе реализован сеттер `description`, при помощи которого устанавливается текст в соответствующий контейнер.

## Файл api.ts

Файл api.ts содержит определения типов и класс для взаимодействия с серверным API.

1. Типы данных
ApiListResponse<Type>
Тип данных, представляющий ответ от сервера в виде списка.

-  total (Число): Общее количество элементов в списке.
-  items (Массив типа Type): Список элементов.

ApiPostMethods
Тип данных, представляющий методы запросов для создания (POST), обновления (PUT) и удаления (DELETE) ресурсов на сервере.

2. Класс Api

Класс Api предоставляет методы для выполнения HTTP-запросов к серверу.
Конструктор
-  baseUrl (Строка): Базовый URL сервера.
-  options (Объект RequestInit): Дополнительные параметры запроса, такие как заголовки и другие настройки.

Методы
-  get(uri: string): Выполняет HTTP-запрос методом GET по указанному URI.
-  post(uri: string, data: object, method: ApiPostMethods = 'POST'): Выполняет HTTP-запрос методом POST или другим указанным методом, отправляя указанные данные.

Защищенный метод
-  handleResponse(response: Response): Promise<object>: Обрабатывает ответ от сервера, возвращая либо данные в случае успешного запроса, либо сообщение об ошибке.


## Файл event.ts

1. EventName
Тип данных, представляющий имя события.

2. Subscriber
Тип данных для обработчика события. Функция, которая принимает данные и выполняет определенные действия.

3. EmitterEvent
Тип данных, представляющий событие, отправляемое эмиттером.
-  eventName (Строка): Имя события.
-  data (Неопределенный): Данные события.